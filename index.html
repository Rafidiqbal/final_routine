<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Offline Study Tracker</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #1e1e1e;
        color: #fff;
        margin: 0;
        padding: 20px;
    }
    h1 {
        text-align: center;
    }
    #controls {
        text-align: center;
        margin-bottom: 20px;
    }
    #addSubjectBtn {
        background: #ff9800;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        cursor: pointer;
        color: #fff;
        font-size: 16px;
    }
    #timer {
        text-align: center;
        font-size: 18px;
        margin-bottom: 20px;
    }
    #overall-container {
        margin-bottom: 30px;
    }
    .progress-bar {
        background: #444;
        border-radius: 5px;
        height: 15px;
        overflow: hidden;
    }
    .progress {
        height: 100%;
        background: #ff9800;
        width: 0%;
    }
    .subject {
        background: #2a2a2a;
        margin-bottom: 15px;
        border-radius: 8px;
        padding: 15px;
    }
    .subject-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: pointer;
    }
    .topics {
        margin-top: 10px;
        display: none;
    }
    .topic {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        background: #333;
        padding: 5px;
        border-radius: 5px;
    }
    .topic button {
        background: #ff9800;
        border: none;
        border-radius: 50%;
        width: 25px;
        height: 25px;
        cursor: pointer;
        color: #000;
    }
    .addTopicBtn {
        margin-top: 10px;
        background: #555;
        color: #fff;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
        border-radius: 5px;
    }
</style>
</head>
<body>

<h1>Offline Study Tracker</h1>

<div id="controls">
    <button id="addSubjectBtn">+ Add Subject</button>
</div>

<div id="timer"></div>

<div id="overall-container">
    <h3>Overall Progress: <span id="overallText">0%</span></h3>
    <div class="progress-bar">
        <div id="overallProgress" class="progress"></div>
    </div>
</div>

<div id="subjects-container"></div>

<script>
    const subjectsContainer = document.getElementById('subjects-container');
    const addSubjectBtn = document.getElementById('addSubjectBtn');
    const overallProgressBar = document.getElementById('overallProgress');
    const overallText = document.getElementById('overallText');

    // Function to create a new subject
    function createSubject(name) {
        const subject = document.createElement('div');
        subject.classList.add('subject');

        subject.innerHTML = `
            <div class="subject-header">
                <span>${name}</span>
                <span class="progress-text">0%</span>
            </div>
            <div class="progress-bar"><div class="progress"></div></div>
            <div class="topics"></div>
            <button class="addTopicBtn">+ Add Topic</button>
        `;

        subjectsContainer.appendChild(subject);
        addSubjectEvents(subject);
    }

    // Add subject events
    function addSubjectEvents(subject) {
        const header = subject.querySelector('.subject-header');
        const topicsDiv = subject.querySelector('.topics');
        const progressBar = subject.querySelector('.progress');
        const progressText = subject.querySelector('.progress-text');
        const addTopicBtn = subject.querySelector('.addTopicBtn');

        header.addEventListener('click', () => {
            topicsDiv.style.display = topicsDiv.style.display === 'block' ? 'none' : 'block';
        });

        addTopicBtn.addEventListener('click', () => {
            const topicName = prompt("Enter topic name:");
            if (topicName) {
                const topic = document.createElement('div');
                topic.classList.add('topic');
                topic.dataset.completed = "0";
                topic.innerHTML = `${topicName} <button>▶</button>`;
                topicsDiv.appendChild(topic);

                topic.querySelector('button').addEventListener('click', (e) => {
                    e.stopPropagation();
                    topic.dataset.completed = topic.dataset.completed === "0" ? "1" : "0";
                    updateProgress(subject);
                });
            }
        });

        function updateProgress(subject) {
            const topics = subject.querySelectorAll('.topic');
            let completed = 0;
            topics.forEach(t => { if(t.dataset.completed === "1") completed++; });
            const percent = topics.length ? Math.round((completed / topics.length) * 100) : 0;
            progressBar.style.width = percent + "%";
            progressText.textContent = percent + "%";
            updateOverallProgress();
        }
    }

    // Overall progress calculation
    function updateOverallProgress() {
        const subjects = document.querySelectorAll('.subject');
        let totalPercent = 0;
        subjects.forEach(subject => {
            const text = subject.querySelector('.progress-text').textContent;
            totalPercent += parseInt(text);
        });
        const overall = subjects.length ? Math.round(totalPercent / subjects.length) : 0;
        overallProgressBar.style.width = overall + "%";
        overallText.textContent = overall + "%";
    }

    // Add subject button event
    addSubjectBtn.addEventListener('click', () => {
        const subjectName = prompt("Enter subject name:");
        if (subjectName) createSubject(subjectName);
    });

    // Initial subjects
    createSubject("Physics");
    createSubject("Mathematics");

    // Countdown Timer (3 months from now)
    const timerDiv = document.getElementById('timer');
    const targetDate = new Date();
    targetDate.setMonth(targetDate.getMonth() + 3);

    function updateTimer() {
        const now = new Date().getTime();
        const distance = targetDate - now;

        if (distance < 0) {
            timerDiv.innerHTML = "Time is up!";
            return;
        }

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        timerDiv.innerHTML = `⏳ ${days}d ${hours}h ${minutes}m ${seconds}s left`;
    }

    setInterval(updateTimer, 1000);
</script>

</body>
</html>
